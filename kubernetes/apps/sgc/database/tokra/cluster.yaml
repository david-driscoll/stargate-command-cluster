---
# yaml-language-server: $schema=https://raw.githubusercontent.com/datreeio/CRDs-catalog/refs/heads/main/mysql.oracle.com/innodbcluster_v2.json
apiVersion: mysql.oracle.com/v2
kind: InnoDBCluster
metadata:
  name: tokra
spec:
  instances: 3
  router:
    instances: 1
  secretName: mycluster-cluster-secret
  backupProfiles:
    - name: default
      dumpInstance:
        storage:
          s3:
            bucketName: tokra-dump
            config: ${APP}-backup-secret
            profile: default
            endpoint: http://minio.${INTERNAL_CLUSTER_SERVICE}:9000
      snapshot:
        storage:
          s3:
            bucketName: tokra-snapshot
            config: ${APP}-backup-secret
            profile: default
            endpoint: http://minio.${INTERNAL_CLUSTER_SERVICE}:9000
  backupSchedules:
    - name: default
      schedule: "0 4 * * *" # Daily at 4 AM
      backupProfileName: default
